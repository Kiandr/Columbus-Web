@Styles.Render("~/Content/css")
@Scripts.Render("~/bundles/googleFireBase")

@{
    ViewBag.Title = "GoogleFireBase";
}

<h2>GoogleFireBase</h2>



<script>
    debugger;
    // Initialize Firebase
    /*
    Auhtor: Kian D.Rad
    Date: Oct 17th 2017
    ReadMe: Test file, to authenticate the firebase
    ToDO: Take out this to javascript file with propoer data models
    */
    function CallGoogleSinIn() {
        debugger;
        console.log("singInToGoogleNow");

        var provider = new firebase.auth.GoogleAuthProvider();
        firebase.auth().signInWithRedirect(provider);
        provider.addScope('https://www.googleapis.com/auth/plus.login');
        firebase.auth().languageCode = 'el';
        firebase.auth().signInWithRedirect(provider);


    };
  var config = {
    apiKey: "AIzaSyBRGDNklfhLgeYdMutMuOQnv3jqfDyCRj0",
    authDomain: "nursenextdoor-ad735.firebaseapp.com",
    databaseURL: "https://nursenextdoor-ad735.firebaseio.com",
    projectId: "nursenextdoor-ad735",
    storageBucket: "nursenextdoor-ad735.appspot.com",
    messagingSenderId: "142428877752"
  };

  function addPic(url) {
      debugger;
      $('#theDiv').prepend($('<img>', { id: 'theImg', src: url }));

  };

  function writeError(string) {
      debugger;
      $('#error').append(string);

  };
  firebase.initializeApp(config);
  //Handle Account Status
  firebase.auth().onAuthStateChanged(user => {
      debugger;
      if(user) {

          console.log(user);


          addPic(user.photoURL);



      }
  });




      // Listening for auth state changes.
      // [START authstatelistener]
  firebase.auth().onAuthStateChanged(function (user) {
      debugger;
          if (user) {
              // User is signed in.
              var displayName = user.displayName;
              var email = user.email;
              var emailVerified = user.emailVerified;
              var photoURL = user.photoURL;
              var isAnonymous = user.isAnonymous;
              var uid = user.uid;
              var providerData = user.providerData;
              // [START_EXCLUDE]
              document.getElementById('quickstart-sign-in-status').textContent = 'Signed in';
              document.getElementById('quickstart-sign-in').textContent = 'Sign out';
              document.getElementById('quickstart-account-details').textContent = JSON.stringify(user, null, '  ');
              // [END_EXCLUDE]
          } else {
              // User is signed out.
              // [START_EXCLUDE]
              document.getElementById('quickstart-sign-in-status').textContent = 'Signed out';
              document.getElementById('quickstart-sign-in').textContent = 'Sign in with GitHub';
              document.getElementById('quickstart-account-details').textContent = 'null';
              document.getElementById('quickstart-oauthtoken').textContent = 'null';
              // [END_EXCLUDE]
          }
          // [START_EXCLUDE]
      
          // [END_EXCLUDE]
      });
      // [END authstatelistener]

     
 

  function CallGoogleSinOut() {


      firebase.auth().signOut().then(function () {
          // Sign-out successful.
          debugger;
          $('#theImg').remove();
      }).catch(function (error) {
          // An error happened.
          writeError("failed singout!");
      });


  };



</script>

<button id="singin" onclick="CallGoogleSinIn()"> Google Single Sing In </button>
<button id="singin" onclick="CallGoogleSinOut()"> Google Single Sing Out</button>
<div id="theDiv"></div>
<div id="error"></div>





